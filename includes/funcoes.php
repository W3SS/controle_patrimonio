<?

function Resposta($texto){
	echo $texto;
}

function ExisteElemento($tabela, $parametro1, $valor1, $parametro2, $valor2){
	
	include('conexao.php');

	$SQL = "select * from ".$tabela." where ".$parametro1." = '".$valor1."'";
    
	if($parametro2 != '')
	   $SQL .= " and ".$parametro2." = '".$valor2."'";

	$result = @pg_query($conexao, $SQL);

    return @pg_num_rows($result);
}

function parseInt($string) {
//	return intval($string);
	if(@preg_match('/(\d+)/', $string, $array)) {
		return $array[1];
	} else {
		return 0;
	}
}

function RemoveCaracteres($string){
	
	$string = str_replace('<','',$string);
	$string = str_replace('>','',$string);
	$string = str_replace('{','',$string);
	$string = str_replace('}','',$string);
	$string = str_replace('$','',$string);
	$string = str_replace('|','',$string);
	$string = str_replace("'",'',$string);
	$string = str_replace("--",'',$string);
	$string = str_replace("&",'',$string);

    return $string;
}

//converte registro do mysql do formato datetime para timestamp
function Datetime_to_Timestamp($str) {

   list($date, $time) = explode(' ', $str);
   list($year, $month, $day) = explode('-', $date);
   list($hour, $minute, $second) = explode(':', $time);

   $timestamp = mktime($hour, $minute, $second, $month, $day, $year);

   return $timestamp;
}

function Segundos_to_Minutos($tempo){

    //obtem os segundos
    $segundos = $tempo % 60;
	//obtem os minutos
    $minutos = ($tempo - $segundos) / 60;
	
	if($segundos < 10)
	   $segundos = '0'.$segundos;

    return '0'.$minutos.':'.$segundos;

}

function ImprimeTitulo($palavra){

  $palavra = str_replace('б','Б',$palavra);
  $palavra = str_replace('&aacute;','&Aacute;',$palavra);
  $palavra = str_replace('а','А',$palavra);
  $palavra = str_replace('&agrave;','&Agrave;',$palavra);
  $palavra = str_replace('в','В',$palavra);
  $palavra = str_replace('&acirc;','&Acirc;',$palavra);
  $palavra = str_replace('г','Г',$palavra);
  $palavra = str_replace('&atilde;','&Atilde;',$palavra);
  $palavra = str_replace('й','Й',$palavra);
  $palavra = str_replace('&eacute;','&Eacute;',$palavra);
  $palavra = str_replace('к','К',$palavra);
  $palavra = str_replace('&ecirc;','&Ecirc;',$palavra);
  $palavra = str_replace('н','Н',$palavra);
  $palavra = str_replace('&iacute;','&Iacute;',$palavra);
  $palavra = str_replace('у','У',$palavra);
  $palavra = str_replace('&oacute;','&Oacute;',$palavra);
  $palavra = str_replace('ф','Ф',$palavra);
  $palavra = str_replace('&ocirc;','&Ocirc;',$palavra);
  $palavra = str_replace('х','Х',$palavra);
  $palavra = str_replace('&otilde;','&Otilde;',$palavra);
  $palavra = str_replace('ъ','Ъ',$palavra);
  $palavra = str_replace('&uacute;','&Uacute;',$palavra);
  $palavra = str_replace('з','З',$palavra);
  $palavra = str_replace('&ccedil;','&Ccedil;',$palavra);

  return strtoupper($palavra);

}

function ImprimeMinusculo($palavra){

  $palavra = str_replace('Б','б',$palavra);
  $palavra = str_replace('&Aacute;','&aacute;',$palavra);
  $palavra = str_replace('А','А',$palavra);
  $palavra = str_replace('&Agrave;','&agrave;',$palavra);
  $palavra = str_replace('В','в',$palavra);
  $palavra = str_replace('&Acirc;','&acirc;',$palavra);
  $palavra = str_replace('Г','г',$palavra);
  $palavra = str_replace('&Atilde;','&atilde;',$palavra);
  $palavra = str_replace('Й','й',$palavra);
  $palavra = str_replace('&Eacute;','&eacute;',$palavra);
  $palavra = str_replace('К','к',$palavra);
  $palavra = str_replace('&Ecirc;','&ecirc;',$palavra);
  $palavra = str_replace('Н','н',$palavra);
  $palavra = str_replace('&Iacute;','&iacute;',$palavra);
  $palavra = str_replace('У','у',$palavra);
  $palavra = str_replace('&Oacute;','&oacute;',$palavra);
  $palavra = str_replace('Ф','ф',$palavra);
  $palavra = str_replace('&Ocirc;','&ocirc;',$palavra);
  $palavra = str_replace('Х','х',$palavra);
  $palavra = str_replace('&Otilde;','&otilde;',$palavra);
  $palavra = str_replace('Ъ','ъ',$palavra);
  $palavra = str_replace('&Uacute;','&uacute;',$palavra);
  $palavra = str_replace('З','з',$palavra);
  $palavra = str_replace('&Ccedil;','&ccedil;',$palavra);

  return strtolower($palavra);

}

function Moeda($valor){
	
	if($valor != '')
  	   $valor = str_replace(",",".",str_replace(".","",$valor));
	else
	   $valor = '0.00';
	   
	return $valor;
}

function SomaSubtraiDias($operacao, $data, $dias){
	
	if($operacao == 'soma')
	   return $retorno = date('Y-m-d', strtotime("+".$dias." days",strtotime($data)));
	else
	   return date('Y-m-d', strtotime("-".$dias." days",strtotime($data)));
}

/**
 * Funзгo que recebe um ano e retorna um boolean informando se ele й ou nгo bissexto.
 *
 * @params (integer) $ano - Ano que deseja saber se й ou nгo bissexto.
 * @return (boolean) $bissesxto - Boolean informando se й bissexto (true) ou se nгo й bissexto (false).
 */
function Bissexto($ano){
    $bissexto = false;
    // Divisнvel por 4 e nгo divisнvel por 100 ou divisнvel por 400
    if((($ano%4) == 0 && ($ano%100) != 0) || ($ano%400) == 0 )
       $bissexto = true;
    
	return $bissexto;
}

function IntervaloDias($inicio, $final){

   $diff =  strtotime($final) - strtotime($inicio);
   
   // 24 horas * 60 Min * 60 seg = 86400
   $dias = ceil($diff/86400);
   
   return $dias;
}

function anti_sql_injection($string){
   
     $string = @get_magic_quotes_gpc() ? @stripslashes($string) : $string;
     $string = @function_exists("mysql_real_escape_string") ? @mysql_real_escape_string($string) : @mysql_escape_string($string);
     return $string;
}

function RemoveAcentuacaoURLAmigavel($texto){
	
	$texto = str_replace(".","",$texto);
	$texto = str_replace(":","",$texto);
	$texto = str_replace(";","",$texto);
	$texto = str_replace(",","",$texto);
	$texto = str_replace("'","",$texto);
	$texto = str_replace("@","",$texto);
	$texto = str_replace("+","",$texto);
	$texto = str_replace('\'',"",$texto);
	$texto = str_replace('"','',$texto);
	$texto = str_replace('?','',$texto);
	$texto = str_replace('!','',$texto);
	$texto = str_replace('%','',$texto);
	$texto = str_replace('&','',$texto);
	$texto = str_replace('(','',$texto);
	$texto = str_replace(')','',$texto);
	$texto = str_replace('[','',$texto);
	$texto = str_replace(']','',$texto);	
	$texto = str_replace('/','',$texto);
	$texto = str_replace('-','_',$texto);
	$texto = str_replace('  ',' ',$texto);
	$texto = str_replace(' ','_',$texto);
	$texto = str_replace('б','a',$texto);
	$texto = str_replace('а','a',$texto);
	$texto = str_replace('г','a',$texto);
	$texto = str_replace('в','a',$texto);
	$texto = str_replace('й','e',$texto);
	$texto = str_replace('и','e',$texto);
	$texto = str_replace('к','e',$texto);
	$texto = str_replace('н','i',$texto);
	$texto = str_replace('м','i',$texto);
	$texto = str_replace('у','o',$texto);
	$texto = str_replace('т','o',$texto);
	$texto = str_replace('ф','o',$texto);
	$texto = str_replace('х','o',$texto);
	$texto = str_replace('ь','u',$texto);
	$texto = str_replace('щ','u',$texto);
	$texto = str_replace('ъ','u',$texto);
	$texto = str_replace('ы','u',$texto);
	$texto = str_replace('з','c',$texto);
	$texto = str_replace('Б','a',$texto);
	$texto = str_replace('А','a',$texto);
	$texto = str_replace('Г','a',$texto);
	$texto = str_replace('В','a',$texto);
	$texto = str_replace('Й','e',$texto);
	$texto = str_replace('И','e',$texto);
	$texto = str_replace('К','e',$texto);
	$texto = str_replace('Н','i',$texto);
	$texto = str_replace('М','i',$texto);
	$texto = str_replace('У','o',$texto);
	$texto = str_replace('Т','o',$texto);
	$texto = str_replace('Ф','o',$texto);
	$texto = str_replace('Х','o',$texto);
	$texto = str_replace('Ы','u',$texto);
	$texto = str_replace('Ъ','u',$texto);
	$texto = str_replace('Ъ','u',$texto);
	$texto = str_replace('З','c',$texto);
	$texto = str_replace("$","s",$texto);
	$texto = str_replace("№","",$texto);
	$texto = str_replace("є","o",$texto);
	$texto = str_replace("Є","a",$texto);
	$texto = str_replace("І","",$texto);
	$texto = str_replace("і","",$texto);
	$texto = str_replace("#","",$texto);
	$texto = str_replace("|","",$texto);
	$texto = str_replace("+","",$texto);
	$texto = str_replace('--','-',$texto);
	
	return strtolower($texto);
	
}

function RemoveAcentuacao($texto){
	
	$texto = strtolower($texto);
	$texto = str_replace(";","",$texto);
	$texto = str_replace(":","",$texto);
	$texto = str_replace(",","",$texto);
	$texto = str_replace("'","",$texto);
	$texto = str_replace('"','',$texto);
	$texto = str_replace('?','',$texto);
	$texto = str_replace('!','',$texto);
	$texto = str_replace('%','',$texto);
	$texto = str_replace('&','',$texto);
	$texto = str_replace('(','',$texto);
	$texto = str_replace(')','',$texto);
	$texto = str_replace('[','',$texto);
	$texto = str_replace(']','',$texto);	
	$texto = str_replace('/','',$texto);
	$texto = str_replace('  ',' ',$texto);
	$texto = str_replace('б','a',$texto);
	$texto = str_replace('а','a',$texto);
	$texto = str_replace('г','a',$texto);
	$texto = str_replace('в','a',$texto);
	$texto = str_replace('й','e',$texto);
	$texto = str_replace('и','e',$texto);
	$texto = str_replace('к','e',$texto);
	$texto = str_replace('н','i',$texto);
	$texto = str_replace('м','i',$texto);
	$texto = str_replace('у','o',$texto);
	$texto = str_replace('т','o',$texto);
	$texto = str_replace('ф','o',$texto);
	$texto = str_replace('х','o',$texto);
	$texto = str_replace('ь','u',$texto);
	$texto = str_replace('щ','u',$texto);
	$texto = str_replace('ъ','u',$texto);
	$texto = str_replace('ы','u',$texto);
	$texto = str_replace('з','c',$texto);
	$texto = str_replace("$","s",$texto);
	$texto = str_replace("№","1",$texto);
	$texto = str_replace("є","&ordm;",$texto);
	$texto = str_replace("Є","&ordf;",$texto);
	$texto = str_replace("І","2",$texto);
	$texto = str_replace("і","3",$texto);
	$texto = str_replace("#","",$texto);
	$texto = str_replace("|","",$texto);
	
	return $texto;
	
}

function GeraFotos($largura, $altura, $imagem, $sufixo){

   //NOME DO ARQUIVO DA MINIATURA
   $imagem_gerada = explode(".", $imagem);
   $imagem_gerada = $imagem_gerada[0]."".$sufixo.""; 

   //CRIA UMA NOVA IMAGEM
   $imagem_orig = ImageCreateFromJPEG($imagem);
   //LARGURA
   $pontoX = ImagesX($imagem_orig);
   //ALTURA
   $pontoY = ImagesY($imagem_orig); 


   //verifica tipo
   if($pontoX > $pontoY){

      //imagem paisagem

   }else{

      //imagem retrato
      $aux = $largura;
      $largura = $altura;
      $altura = $aux;    

   }

   //CRIA O THUMBNAIL
   $imagem_fin = ImageCreateTrueColor($largura, $altura); 

   //COPIA A IMAGEM ORIGINAL PARA DENTRO
   ImageCopyResampled($imagem_fin, $imagem_orig, 0, 0, 0, 0, $largura+1, $altura+1, $pontoX, $pontoY); 

   //SALVA A IMAGEM
   ImageJPEG($imagem_fin, $imagem_gerada,80); 

   //LIBERA A MEMУRIA
   ImageDestroy($imagem_orig);
   ImageDestroy($imagem_fin);
}

function formatData($val){
	$arr = @explode("-", $val);
	return @date("d/m/Y", @mktime(0,0,0, $arr[1], $arr[2], $arr[0]));
}

function Dataformat($val){
	$arr = @explode("/", $val);
	return ''.$arr[2].'-'.$arr[1].'-'.$arr[0].'';
}

function DataPontoShort($val){
	$arr = @explode("-", $val);
	return @date("d.m.y", @mktime(0,0,0, $arr[1], $arr[2], $arr[0]));
}

function DataPontoLong($val){
	$arr = @explode("-", $val);
	return @date("d.m.Y", @mktime(0,0,0, $arr[1], $arr[2], $arr[0]));
}

function formatData2($val){

  $dia = @substr($val,8,2);
  $mes = @substr($val,5,2);
  $ano = @substr($val,0,4);

  return ''.$dia.'/'.$mes.'/'.$ano.'';

}

function TipoImagem($foto){
  
   list($width, $height) = @getimagesize($foto);

   if($width > $height)
      
      $retorno = 'paisagem';
          
   if($width < $height)

      $retorno = 'retrato';
 
   return $retorno;

}


function retorna_data($data, $dia_semana, $nome_mes){

   $retorno = '';	
   
   //Bloco de cуdigos para dias da semana
   if($dia_semana == true){
	  
	  $week = strftime('%w',strtotime($data));
	   
      if($week == 0)     {$semana = "Domingo";}
      elseif($week == 1) {$semana = "Segunda-feira";}
      elseif($week == 2) {$semana = "Ter&ccedil;a-feira";}
      elseif($week == 3) {$semana = "Quarta-feira";}
      elseif($week == 4) {$semana = "Quinta-feira";}
      elseif($week == 5) {$semana = "Sexta-feira";}
      elseif($week == 6) {$semana = "S&aacute;bado";}
	  
	  $retorno = $semana.'@';
	  
   }
   
   //Bloco de cуdigos para os meses
   if($nome_mes == true){
      if(substr($data,5,2) == '01') {$mes="Janeiro";}
      elseif(substr($data,5,2) == '02') {$mes="Fevereiro";}
      elseif(substr($data,5,2) == '03') {$mes="Mar&ccedil;o";}      
      elseif(substr($data,5,2) == '04') {$mes="Abril";}
      elseif(substr($data,5,2) == '05') {$mes="Maio";}
      elseif(substr($data,5,2) == '06') {$mes="Junho";}
      elseif(substr($data,5,2) == '07') {$mes="Julho";}
      elseif(substr($data,5,2) == '08') {$mes="Agosto";}
      elseif(substr($data,5,2) == '09') {$mes="Setembro";}
      elseif(substr($data,5,2) == '10') {$mes="Outubro";}
      elseif(substr($data,5,2) == '11') {$mes="Novembro";}
      elseif(substr($data,5,2) == '12') {$mes="Dezembro";}
	  
	  $retorno .= $mes;
   }
   
   //juntando os dias da semana e os meses..tratar o retorno com explode('@',$retorno);
   return $retorno;
}

function MenuVertical($pagina){
	
	
  //buscando conteudo na tebela sub_paginas
  $SQL = "select id, cod_pagina, titulo, conteudo, destino, alvo from sub_paginas where relacao = '".$pagina."' order by titulo asc";
  $result = @mysql_query($SQL);
  

  if(@mysql_num_rows($result) > 0 ){//lista os submenus
  
     echo('<ul>');

     for($i = 1; $nivel1 = @mysql_fetch_row($result); $i++){
 
           //verificar se nгo й o ultimo item do menu...adiciona o estilo da borda inferior
		   if($i != @mysql_num_rows($result))
		      $borda = " style=\"border-bottom:1px solid #CCC;\"";
           else
		      $borda = '';
 
 
           //verificar se tem conteudo interno e/ou externo            
           if($nivel1[3] == "" && $nivel1[4] == "") 
              echo('<li'.$borda.'><a style="cursor:default;" href="javascript:void(0);">'.$nivel1[2].'</a>');
           else if($nivel1[3] != "" && $nivel1[4] == "")
              echo('<li'.$borda.'><a href="pagina.php?id='.$nivel1[0].'">'.$nivel1[2].'</a>');
		   else
              echo('<li'.$borda.'><a href="'.$nivel1[4].'" target="'.$nivel1[5].'">'.$nivel1[2].'</a>');

		   $SQL2 = "select id, cod_sub_pagina, titulo, destino, alvo from sub_sub_paginas where relacao = '".$pagina."' and cod_sub_pagina = '".$nivel1[0]."' order by titulo asc";
		   $result2 = @mysql_query($SQL2);
		   $total2 = @mysql_num_rows($result2);
				
		   if($total2 == 0)//nao tem subpaginas
		      echo('</li>');
		   else{
			  echo('<ul style="margin-left:-33px; margin-top:-1px;">');
		      
              for($j = 1; $nivel2 = @mysql_fetch_row($result2); $j++){

                  //verificar se nгo й o ultimo item do menu...adiciona o estilo da borda inferior
				  if($j != @mysql_num_rows($result2))
					 $sub_borda = " style=\"border-bottom:1px solid #CCC;\"";
				  else
					 $sub_borda = '';

                    //verificar conteudo interno ou externo
                    if($nivel2[3] == "")
                       echo('<li'.$sub_borda.'><a href="subpagina.php?id='.$nivel2[0].'">'.$nivel2[2].'</a>');
		            else
                       echo('<li'.$sub_borda.'><a href="'.$nivel2[3].'" target="'.$nivel2[4].'">'.$nivel2[2].'</a>');
					
				    echo('</li>');
				   
	 
              }//for
			  echo('</ul>');
			  echo('</li>');
		   
           }//else
   
	 }//for
     echo('</ul>');
	 
  }//if

}

function validaCPF($cpf){

	// Verifica se nenhuma das sequкncias abaixo foi digitada, caso seja, retorna falso
    if (strlen($cpf) != 11 || $cpf == '00000000000' || $cpf == '11111111111' || $cpf == '22222222222' || $cpf == '33333333333' || $cpf == '44444444444' || $cpf == '55555555555' || $cpf == '66666666666' || $cpf == '77777777777' || $cpf == '88888888888' || $cpf == '99999999999')
	{
	return false;
    }
	else
	{   // Calcula os nъmeros para verificar se o CPF й verdadeiro
        for ($t = 9; $t < 11; $t++) {
            for ($d = 0, $c = 0; $c < $t; $c++) {
                $d += $cpf{$c} * (($t + 1) - $c);
            }

            $d = ((10 * $d) % 11) % 10;

            if ($cpf{$c} != $d) {
                return false;
            }
        }

        return true;
    }
}

function is_cnpj($str) {
		
	$sum1 = 0;
	$sum2 = 0;
	$sum3 = 0;
	$calc1 = 5;
	$calc2 = 6;

	for ($i=0; $i <= 12; $i++) {
		$calc1 = $calc1 < 2 ? 9 : $calc1;
		$calc2 = $calc2 < 2 ? 9 : $calc2;

		if ($i <= 11)
			$sum1 += $str[$i] * $calc1;

		$sum2 += $str[$i] * $calc2;
		$sum3 += $str[$i];
		$calc1--;
		$calc2--;
	}

	$sum1 %= 11;
	$sum2 %= 11;

	return ($sum3 && $str[12] == ($sum1 < 2 ? 0 : 11 - $sum1) && $str[13] == ($sum2 < 2 ? 0 : 11 - $sum2)) ? $str : false;
}

function GeraSenha($tamanho, $maiuscula, $minuscula, $numeros){

  $maius = "ABCDEFGHIJKLMNOPQRSTUWXYZ";
  $minus = "abcdefghijklmnopqrstuwxyz";
  $numer = "0123456789";

  $base = '';

  $base .= ($maiuscula) ? $maius : '';

  $base .= ($minuscula) ? $minus : '';

  $base .= ($numeros) ? $numer : '';

  srand((float) microtime() * 10000000);

  $senha = '';

  for ($i = 0; $i < $tamanho; $i++)
      $senha .= substr($base, rand(0, strlen($base)-1), 1);

  return $senha;

}

function UrlAtual(){
   $dominio= $_SERVER['HTTP_HOST'];
   $url = "http://" . $dominio. $_SERVER['REQUEST_URI'];
   return $url;
}

function resumo($string,$chars) {
  if (strlen($string) > $chars) {
    while (substr($string,$chars,1) <> ' ' && ($chars < strlen($string))){
      $chars++;
    }
  }
  return substr($string,0,$chars);
}

function calcula_idade($data_nascimento, $data_calcula){
    // as datas devem ser no formato aaaa-mm-dd
 
    //conversгo das datas para o formato de tempo linux
    $data_nascimento = strtotime($data_nascimento." 00:00:00");
    $data_calcula = strtotime($data_calcula." 00:00:00");
 
    //cбlculo da idade fazendo a diferenзa entre as duas datas
    $idade = floor(abs($data_calcula-$data_nascimento)/60/60/24/365);
 
    return($idade);
} 

?>